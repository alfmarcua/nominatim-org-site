<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://nominatim.org/data-sources/Wikipedia-Wikidata/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Wikipedia & Wikidata - Nominatim 3.5.2</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../../extra.css" rel="stylesheet" />
  <link href="../../styles.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Wikipedia & Wikidata";
    var mkdocs_page_input_path = "data-sources/Wikipedia-Wikidata.md";
    var mkdocs_page_url = "/data-sources/Wikipedia-Wikidata/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Nominatim 3.5.2</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Introduction</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API Reference</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/Overview/">Overview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/Search/">Search</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/Reverse/">Reverse</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/Lookup/">Address Lookup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/Details/">Details</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/Status/">Status</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/Output/">Place Output Formats</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/Faq/">FAQ</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Administration Guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../admin/Installation/">Basic Installation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../admin/Import/">Importing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../admin/Update/">Updating</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../admin/Advanced-Installations/">Advanced Installations</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../admin/Migration/">Migration from older Versions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../admin/Faq/">Troubleshooting</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Developers Guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../develop/overview/">Overview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../develop/Import/">OSM Data Import</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../develop/Ranking/">Place Ranking</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../develop/Postcodes/">Postcodes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../develop/Setup/">Setup Test Environment</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../develop/Documentation/">Documentation</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">External Data Sources</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../US-Tiger/">US Census (Tiger)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GB-Postcodes/">GB Postcodes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Country-Grid/">Country Grid</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Wikipedia & Wikidata</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#create-a-new-postgres-db-for-processing">Create a new postgres DB for Processing</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Appendix</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../appendix/Install-on-Centos-7/">Installation on CentOS 7</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../appendix/Install-on-Centos-8/">Installation on CentOS 8</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../appendix/Install-on-Ubuntu-18/">Installation on Ubuntu 18</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../appendix/Install-on-Ubuntu-20/">Installation on Ubuntu 20</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Nominatim 3.5.2</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>External Data Sources &raquo;</li>
        
      
    
    <li>Wikipedia & Wikidata</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/openstreetmap/Nominatim/edit/master/docs/data-sources/Wikipedia-Wikidata.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="add-wikipedia-and-wikidata-to-nominatim">Add Wikipedia and Wikidata to Nominatim<a class="headerlink" href="#add-wikipedia-and-wikidata-to-nominatim" title="Permanent link"></a></h2>
<p>OSM contributors frequently tag items with links to Wikipedia and Wikidata. Nominatim can use the page ranking of Wikipedia pages to help indicate the relative importance of osm features. This is done by calculating an importance score between 0 and 1 based on the number of inlinks to an article for a location. If two places have the same name and one is more important than the other, the wikipedia score often points to the correct place. </p>
<p>These scripts extract and prepare both Wikipedia page rank and Wikidata links for use in Nominatim.  </p>
<h4 id="create-a-new-postgres-db-for-processing">Create a new postgres DB for Processing<a class="headerlink" href="#create-a-new-postgres-db-for-processing" title="Permanent link"></a></h4>
<p>Due to the size of initial and intermediate tables, processing can be done in an external database:</p>
<div class="codehilite"><pre><span></span><code><span class="err">CREATE DATABASE wikiprocessingdb;</span>
</code></pre></div>


<hr />
<h2 id="wikipedia">Wikipedia<a class="headerlink" href="#wikipedia" title="Permanent link"></a></h2>
<p>Processing these data requires a large amount of disk space (~1TB) and considerable time (&gt;24 hours).</p>
<h4 id="import-process-wikipedia-tables">Import &amp; Process Wikipedia tables<a class="headerlink" href="#import-process-wikipedia-tables" title="Permanent link"></a></h4>
<p>This step downloads and converts <a href="https://dumps.wikimedia.org/">Wikipedia</a> page data SQL dumps to postgreSQL files which can be imported and processed with pagelink information from Wikipedia language sites to calculate importance scores.</p>
<ul>
<li>
<p>The script will processes data from whatever set of Wikipedia languages are specified in the initial languages array</p>
</li>
<li>
<p>Note that processing the top 40 Wikipedia languages can take over a day, and will add nearly 1TB to the processing database. The final output tables will be approximately 11GB and 2GB in size</p>
</li>
</ul>
<p>To download, convert, and import the data, then process summary statistics and compute importance scores, run:</p>
<div class="codehilite"><pre><span></span><code><span class="err">./import_wikipedia.sh</span>
</code></pre></div>


<hr />
<h2 id="wikidata">Wikidata<a class="headerlink" href="#wikidata" title="Permanent link"></a></h2>
<p>This script downloads and processes Wikidata to enrich the previously created Wikipedia tables for use in Nominatim.</p>
<h4 id="import-process-wikidata">Import &amp; Process Wikidata<a class="headerlink" href="#import-process-wikidata" title="Permanent link"></a></h4>
<p>This step downloads and converts <a href="https://dumps.wikimedia.org/wikidatawiki/">Wikidata</a> page data SQL dumps to postgreSQL files which can be processed and imported into Nominatim database. Also utilizes Wikidata Query Service API to discover and include place types.</p>
<ul>
<li>
<p>Script presumes that the user has already processed Wikipedia tables as specified above</p>
</li>
<li>
<p>Script requires wikidata_place_types.txt and wikidata_place_type_levles.csv</p>
</li>
<li>
<p>script requires the <a href="https://stedolan.github.io/jq/">jq json parser</a></p>
</li>
<li>
<p>Script processes data from whatever set of Wikipedia languages are specified in the initial languages array</p>
</li>
<li>
<p>Script queries Wikidata Query Service API and imports all instances of place types listed in wikidata_place_types.txt</p>
</li>
<li>
<p>Script updates wikipedia_articles table with extracted wikidata </p>
</li>
</ul>
<p>By including Wikidata in the wikipedia_articles table, new connections can be made on the fly from the Nominatim placex table to wikipedia_article importance scores. </p>
<p>To download, convert, and import the data, then process required items, run:</p>
<div class="codehilite"><pre><span></span><code><span class="err">./import_wikidata.sh</span>
</code></pre></div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../appendix/Install-on-Centos-7/" class="btn btn-neutral float-right" title="Installation on CentOS 7">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Country-Grid/" class="btn btn-neutral" title="Country Grid"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/openstreetmap/Nominatim/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../Country-Grid/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../appendix/Install-on-Centos-7/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
