<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Installation on Ubuntu 18 - Nominatim 3.4.2</title>
  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../../extra.css" rel="stylesheet">
  <link href="../../styles.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Installation on Ubuntu 18";
    var mkdocs_page_input_path = "appendix/Install-on-Ubuntu-18.md";
    var mkdocs_page_url = "/appendix/Install-on-Ubuntu-18/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Nominatim 3.4.2</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">API Reference</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../api/Overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Search/">Search</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Reverse/">Reverse</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Lookup/">Address Lookup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Details/">Details</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Output/">Place Output Formats</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Faq/">FAQ</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Administration Guide</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../admin/Installation/">Basic Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../admin/Import-and-Update/">Importing and Updating</a>
                </li>
                <li class="">
                    
    <a class="" href="../../admin/Migration/">Migration from older Versions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../admin/Faq/">Troubleshooting</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Developers Guide</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../develop/overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../develop/Import/">OSM Data Import</a>
                </li>
                <li class="">
                    
    <a class="" href="../../develop/Ranking/">Place Ranking</a>
                </li>
                <li class="">
                    
    <a class="" href="../../develop/Postcodes/">Postcodes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../develop/Documentation/">Documentation</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">External Data Sources</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../data-sources/overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../data-sources/US-Tiger/">US Census (Tiger)</a>
                </li>
                <li class="">
                    
    <a class="" href="../../data-sources/GB-Postcodes/">GB Postcodes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../data-sources/Country-Grid/">Country Grid</a>
                </li>
                <li class="">
                    
    <a class="" href="../../data-sources/Wikipedia-Wikidata/">Wikipedia & Wikidata</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Appendix</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Install-on-Centos-7/">Installation on CentOS 7</a>
                </li>
                <li class="">
                    
    <a class="" href="../Install-on-Ubuntu-16/">Installation on Ubuntu 16</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Installation on Ubuntu 18</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#installing-the-required-software">Installing the Required Software</a></li>
    

    <li class="toctree-l3"><a href="#system-configuration">System Configuration</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#creating-dedicated-user-accounts">Creating Dedicated User Accounts</a></li>
        
            <li><a class="toctree-l4" href="#setting-up-postgresql">Setting up PostgreSQL</a></li>
        
            <li><a class="toctree-l4" href="#setting-up-the-apache-webserver">Setting up the Apache Webserver</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#installing-nominatim">Installing Nominatim</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#building-and-configuration">Building and Configuration</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Nominatim 3.4.2</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Appendix &raquo;</li>
        
      
    
    <li>Installation on Ubuntu 18</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/openstreetmap/Nominatim/edit/master/docs/appendix/Install-on-Ubuntu-18.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><em>Note:</em> these installation instructions are also available in executable
        form for use with vagrant under vagrant/Install-on-Ubuntu-18.sh.</p>
<h1 id="installing-the-required-software">Installing the Required Software<a class="headerlink" href="#installing-the-required-software" title="Permanent link"></a></h1>
<p>These instructions expect that you have a freshly installed Ubuntu 18.04.</p>
<p>Make sure all packages are are up-to-date by running:</p>
<div class="codehilite"><pre><span></span>sudo apt-get update -qq
</pre></div>


<p>Now you can install all packages needed for Nominatim:</p>
<div class="codehilite"><pre><span></span>sudo apt-get install -y build-essential cmake g++ libboost-dev libboost-system-dev \
                        libboost-filesystem-dev libexpat1-dev zlib1g-dev libxml2-dev \
                        libbz2-dev libpq-dev libproj-dev \
                        postgresql-server-dev-10 postgresql-10-postgis-2.4 \
                        postgresql-contrib-10 postgresql-10-postgis-scripts \
                        apache2 php php-pgsql libapache2-mod-php \
                        php-intl git
</pre></div>


<p>If you want to run the test suite, you need to install the following
additional packages:</p>
<div class="codehilite"><pre><span></span>sudo apt-get install -y python3-setuptools python3-dev python3-pip \
                        python3-psycopg2 python3-tidylib phpunit php-cgi

pip3 install --user behave nose

composer global require &quot;squizlabs/php_codesniffer=*&quot;
sudo ln -s ~/.config/composer/vendor/bin/phpcs /usr/bin/
</pre></div>


<h1 id="system-configuration">System Configuration<a class="headerlink" href="#system-configuration" title="Permanent link"></a></h1>
<p>The following steps are meant to configure a fresh Ubuntu installation
for use with Nominatim. You may skip some of the steps if you have your
OS already configured.</p>
<h2 id="creating-dedicated-user-accounts">Creating Dedicated User Accounts<a class="headerlink" href="#creating-dedicated-user-accounts" title="Permanent link"></a></h2>
<p>Nominatim will run as a global service on your machine. It is therefore
best to install it under its own separate user account. In the following
we assume this user is called nominatim and the installation will be in
/srv/nominatim. To create the user and directory run:</p>
<div class="codehilite"><pre><span></span>sudo useradd -d /srv/nominatim -s /bin/bash -m nominatim
</pre></div>


<p>You may find a more suitable location if you wish.</p>
<p>To be able to copy and paste instructions from this manual, export
user name and home directory now like this:</p>
<div class="codehilite"><pre><span></span>export USERNAME=nominatim
export USERHOME=/srv/nominatim
</pre></div>


<p><strong>Never, ever run the installation as a root user.</strong> You have been warned.</p>
<p>Make sure that system servers can read from the home directory:</p>
<div class="codehilite"><pre><span></span>chmod a+x $USERHOME
</pre></div>


<h2 id="setting-up-postgresql">Setting up PostgreSQL<a class="headerlink" href="#setting-up-postgresql" title="Permanent link"></a></h2>
<p>Tune the postgresql configuration, which is located in 
<code>/etc/postgresql/10/main/postgresql.conf</code>. See section <em>Postgres Tuning</em> in
<a href="../../admin/Installation/#postgresql-tuning">the installation page</a>
for the parameters to change.</p>
<p>Restart the postgresql service after updating this config file.</p>
<div class="codehilite"><pre><span></span>sudo systemctl restart postgresql
</pre></div>


<p>Finally, we need to add two postgres users: one for the user that does
the import and another for the webserver which should access the database
for reading only:</p>
<div class="codehilite"><pre><span></span>sudo -u postgres createuser -s $USERNAME
sudo -u postgres createuser www-data
</pre></div>


<h2 id="setting-up-the-apache-webserver">Setting up the Apache Webserver<a class="headerlink" href="#setting-up-the-apache-webserver" title="Permanent link"></a></h2>
<p>You need to create an alias to the website directory in your apache
configuration. Add a separate nominatim configuration to your webserver:</p>
<div class="codehilite"><pre><span></span>sudo tee /etc/apache2/conf-available/nominatim.conf <span class="s">&lt;&lt; EOFAPACHECONF</span>
<span class="s">&lt;Directory &quot;$USERHOME/Nominatim/build/website&quot;&gt;</span>
<span class="s">  Options FollowSymLinks MultiViews</span>
<span class="s">  AddType text/html   .php</span>
<span class="s">  DirectoryIndex search.php</span>
<span class="s">  Require all granted</span>
<span class="s">&lt;/Directory&gt;</span>

<span class="s">Alias /nominatim $USERHOME/Nominatim/build/website</span>
<span class="s">EOFAPACHECONF</span>
</pre></div>


<p>Then enable the configuration and restart apache</p>
<div class="codehilite"><pre><span></span>sudo a2enconf nominatim
sudo systemctl restart apache2
</pre></div>


<h1 id="installing-nominatim">Installing Nominatim<a class="headerlink" href="#installing-nominatim" title="Permanent link"></a></h1>
<h2 id="building-and-configuration">Building and Configuration<a class="headerlink" href="#building-and-configuration" title="Permanent link"></a></h2>
<p>Get the source code for the release and unpack it</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> <span class="nv">$USERHOME</span>
wget https://nominatim.org/release/Nominatim-3.4.2.tar.bz2
tar xf Nominatim-3.4.2.tar.bz2
</pre></div>


<p>The code must be built in a separate directory. Create this directory,
then configure and build Nominatim in there:</p>
<div class="codehilite"><pre><span></span>mkdir build
<span class="nb">cd</span> build
cmake <span class="nv">$USERHOME</span>/Nominatim-3.4.2
make
</pre></div>


<p>You need to create a minimal configuration file that tells nominatim
where it is located on the webserver:</p>
<div class="codehilite"><pre><span></span>tee settings/local.php <span class="s">&lt;&lt; EOF</span>
<span class="s">&lt;?php</span>
<span class="s"> @define(&#39;CONST_Website_BaseURL&#39;, &#39;/nominatim/&#39;);</span>
<span class="s">EOF</span>
</pre></div>


<p>Nominatim is now ready to use. Continue with
<a href="../../admin/Import-and-Update/">importing a database from OSM data</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../Install-on-Ubuntu-16/" class="btn btn-neutral" title="Installation on Ubuntu 16"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/openstreetmap/Nominatim/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../Install-on-Ubuntu-16/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
